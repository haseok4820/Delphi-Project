program Project_PreView;

uses
  System.StartUpCopy,
  FMX.Forms,
  Windows,
  uMain in 'uMain.pas' {Form_SMPreview},
  uTextBackup in 'uTextBackup.pas' {fmBackup},
  uForm_Receipt in 'uForm_Receipt.pas' {Form_Receipt};

{$R *.res}

var
  PreView_Mutex: THandle;
  Exe_Handle: Integer;

begin
  PreView_Mutex := CreateMutex(nil, True, 'MutexFM_Preivew');
  if (PreView_Mutex > 0) AND (GetLastError = 0) then
  begin
    try
      Application.Initialize;
      Application.CreateForm(TForm_SMPreview, Form_SMPreview);
  Application.Run;
    except
      Application.Terminate;
    end;

    if PreView_Mutex > 0 then
      CloseHandle(PreView_Mutex);
  end
  else
  begin
    Exe_Handle := FindWindow('', nil);
    ShowWindow(Exe_Handle, SW_SHOW);
  end;

end.
